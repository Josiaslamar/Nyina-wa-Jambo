<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Concorde Pharmacy - Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Data Storage
        let medicines = [
          {
            id: 1,
            name: "Amoxicillin",
            category: "Antibiotics",
            stock: 150,
            expiry: "2025-12-15",
            price: 12.99,
          },
          {
            id: 2,
            name: "Paracetamol",
            category: "Pain Relief",
            stock: 8,
            expiry: "2025-10-20",
            price: 5.99,
          },
          {
            id: 3,
            name: "Vitamin D3",
            category: "Vitamins",
            stock: 200,
            expiry: "2026-03-10",
            price: 8.49,
          },
          {
            id: 4,
            name: "Lisinopril",
            category: "Heart",
            stock: 75,
            expiry: "2025-08-30",
            price: 15.99,
          },
          {
            id: 5,
            name: "Metformin",
            category: "Diabetes",
            stock: 5,
            expiry: "2025-11-25",
            price: 22.99,
          },
        ];

        let suppliers = [
          {
            id: 1,
            name: "PharmaCorp Ltd",
            contact: "+1-555-0123",
            items: "Antibiotics, Pain Relief",
            email: "contact@pharmacorp.com",
          },
          {
            id: 2,
            name: "MediSupply Inc",
            contact: "+1-555-0456",
            items: "Vitamins, Supplements",
            email: "orders@medisupply.com",
          },
          {
            id: 3,
            name: "HealthSource",
            contact: "+1-555-0789",
            items: "Heart Medications, Diabetes",
            email: "info@healthsource.com",
          },
        ];

        let customers = [
          {
            id: 1,
            name: "John Smith",
            phone: "+1-555-1111",
            notes: "Diabetes patient, allergic to penicillin",
            lastVisit: "2025-08-20",
          },
          {
            id: 2,
            name: "Mary Johnson",
            phone: "+1-555-2222",
            notes: "Hypertension medication",
            lastVisit: "2025-08-25",
          },
          {
            id: 3,
            name: "Robert Wilson",
            phone: "+1-555-3333",
            notes: "Regular vitamin supplements",
            lastVisit: "2025-08-27",
          },
        ];

        let orders = [
          {
            id: 1001,
            customerId: 1,
            customerName: "John Smith",
            medicines: [
              { id: 5, name: "Metformin", quantity: 2, price: 22.99 },
            ],
            total: 45.98,
            date: "2025-08-28",
            status: "Completed",
          },
          {
            id: 1002,
            customerId: 2,
            customerName: "Mary Johnson",
            medicines: [
              { id: 4, name: "Lisinopril", quantity: 1, price: 15.99 },
            ],
            total: 15.99,
            date: "2025-08-27",
            status: "Pending",
          },
          {
            id: 1003,
            customerId: 3,
            customerName: "Robert Wilson",
            medicines: [
              { id: 3, name: "Vitamin D3", quantity: 3, price: 8.49 },
            ],
            total: 25.47,
            date: "2025-08-26",
            status: "Completed",
          },
        ];

        let currentEditId = null;
        let currentSection = "overview";

        // Navigation Functions
        document
          .getElementById("homeBtn")
          .addEventListener("click", showLandingPage);
        document
          .getElementById("dashboardBtn")
          .addEventListener("click", showDashboard);
        document
          .getElementById("getStartedBtn")
          .addEventListener("click", showDashboard);

        function showLandingPage() {
          document.getElementById("landingPage").style.display = "block";
          document.getElementById("dashboardPage").style.display = "none";
        }

        function showDashboard() {
          document.getElementById("landingPage").style.display = "none";
          document.getElementById("dashboardPage").style.display = "block";
          showSection("overview");
          updateDashboardStats();
        }

        // Sidebar Navigation
        document.querySelectorAll(".sidebar-btn").forEach((btn) => {
          btn.addEventListener("click", (e) => {
            const section = e.target.getAttribute("data-section");
            showSection(section);
          });
        });

        function showSection(section) {
          // Hide all sections
          document
            .querySelectorAll(".section")
            .forEach((s) => s.classList.add("hidden"));

          // Show selected section
          document
            .getElementById(section + "-section")
            .classList.remove("hidden");

          // Update sidebar active state
          document.querySelectorAll(".sidebar-btn").forEach((btn) => {
            btn.classList.remove("bg-primary", "text-white");
            btn.classList.add("text-gray-700");
          });

          document
            .querySelector(`[data-section="${section}"]`)
            .classList.remove("text-gray-700");
          document
            .querySelector(`[data-section="${section}"]`)
            .classList.add("bg-primary", "text-white");

          currentSection = section;

          // Load section data
          switch (section) {
            case "medicines":
              renderMedicines();
              break;
            case "suppliers":
              renderSuppliers();
              break;
            case "customers":
              renderCustomers();
              break;
            case "orders":
              renderOrders();
              break;
            case "reports":
              renderReports();
              break;
            case "overview":
              updateDashboardStats();
              renderRecentActivity();
              break;
          }
        }

        // Dashboard Stats
        function updateDashboardStats() {
          document.getElementById("totalMedicines").textContent =
            medicines.length;
          document.getElementById("lowStock").textContent = medicines.filter(
            (m) => m.stock < 10
          ).length;
          document.getElementById("totalOrders").textContent = orders.length;

          const todayRevenue = orders
            .filter((o) => o.date === new Date().toISOString().split("T")[0])
            .reduce((sum, o) => sum + o.total, 0);
          document.getElementById(
            "todayRevenue"
          ).textContent = `${todayRevenue.toFixed(2)}`;
        }

        function renderRecentActivity() {
          const activityContainer = document.getElementById("recentActivity");
          const activities = [
            {
              action: "New order created",
              details: `Order #${orders[orders.length - 1]?.id || 1001}`,
              time: "2 hours ago",
              icon: "shopping-bag",
            },
            {
              action: "Low stock alert",
              details: "Paracetamol (8 units remaining)",
              time: "4 hours ago",
              icon: "exclamation-triangle",
            },
            {
              action: "Medicine added",
              details: "Vitamin D3 restocked",
              time: "1 day ago",
              icon: "plus-circle",
            },
            {
              action: "Customer registered",
              details: "New customer: Robert Wilson",
              time: "2 days ago",
              icon: "user-plus",
            },
          ];

          activityContainer.innerHTML = activities
            .map(
              (activity) => `
                <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-lg">
                    <div class="w-8 h-8 bg-primary bg-opacity-10 rounded-full flex items-center justify-center">
                        <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            ${getActivityIcon(activity.icon)}
                        </svg>
                    </div>
                    <div class="flex-1">
                        <p class="font-medium text-gray-900">${
                          activity.action
                        }</p>
                        <p class="text-sm text-gray-600">${activity.details}</p>
                    </div>
                    <span class="text-sm text-gray-500">${activity.time}</span>
                </div>
            `
            )
            .join("");
        }

        function getActivityIcon(iconType) {
          const icons = {
            "shopping-bag":
              '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>',
            "exclamation-triangle":
              '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.232 16.5c-.77.833.192 2.5 1.732 2.5z"></path>',
            "plus-circle":
              '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>',
            "user-plus":
              '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path>',
          };
          return icons[iconType] || icons["plus-circle"];
        }

        // Medicines Management
        function renderMedicines() {
          const tbody = document.getElementById("medicinesTable");
          const searchTerm =
            document.getElementById("medicineSearch")?.value.toLowerCase() ||
            "";
          const categoryFilter =
            document.getElementById("categoryFilter")?.value || "";

          let filteredMedicines = medicines.filter((medicine) => {
            const matchesSearch =
              medicine.name.toLowerCase().includes(searchTerm) ||
              medicine.category.toLowerCase().includes(searchTerm);
            const matchesCategory =
              !categoryFilter || medicine.category === categoryFilter;
            return matchesSearch && matchesCategory;
          });

          tbody.innerHTML = filteredMedicines
            .map((medicine) => {
              const isLowStock = medicine.stock < 10;
              const isExpiring =
                new Date(medicine.expiry) <
                new Date(Date.now() + 30 * 24 * 60 * 60 * 1000);

              return `
                    <tr class="${isLowStock ? "low-stock" : ""}">
                        <td class="px-6 py-4">
                            <div class="font-medium text-gray-900">${
                              medicine.name
                            }</div>
                            ${
                              isExpiring
                                ? '<div class="text-sm text-red-600">⚠️ Expiring soon</div>'
                                : ""
                            }
                        </td>
                        <td class="px-6 py-4 text-gray-900">${
                          medicine.category
                        }</td>
                        <td class="px-6 py-4">
                            <span class="${
                              isLowStock
                                ? "text-red-600 font-semibold"
                                : "text-gray-900"
                            }">${medicine.stock}</span>
                            ${
                              isLowStock
                                ? ' <span class="text-red-500 text-sm">⚠️ Low</span>'
                                : ""
                            }
                        </td>
                        <td class="px-6 py-4 text-gray-900">${formatDate(
                          medicine.expiry
                        )}</td>
                        <td class="px-6 py-4 text-gray-900">${
                          medicine.price
                        }</td>
                        <td class="px-6 py-4">
                            <div class="flex space-x-2">
                                <button onclick="editMedicine(${
                                  medicine.id
                                })" class="text-blue-600 hover:text-blue-800">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                    </svg>
                                </button>
                                <button onclick="deleteMedicine(${
                                  medicine.id
                                })" class="text-red-600 hover:text-red-800">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                    </svg>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            })
            .join("");
        }

        // Medicine Modal Functions
        document
          .getElementById("addMedicineBtn")
          .addEventListener("click", () => openMedicineModal());
        document
          .getElementById("closeMedicineModal")
          .addEventListener("click", closeMedicineModal);
        document
          .getElementById("cancelMedicine")
          .addEventListener("click", closeMedicineModal);
        document
          .getElementById("medicineForm")
          .addEventListener("submit", saveMedicine);

        // Search and Filter
        document
          .getElementById("medicineSearch")
          .addEventListener("input", renderMedicines);
        document
          .getElementById("categoryFilter")
          .addEventListener("change", renderMedicines);

        function openMedicineModal(medicineId = null) {
          const modal = document.getElementById("medicineModal");
          const title = document.getElementById("medicineModalTitle");
          const form = document.getElementById("medicineForm");

          currentEditId = medicineId;

          if (medicineId) {
            title.textContent = "Edit Medicine";
            const medicine = medicines.find((m) => m.id === medicineId);
            document.getElementById("medicineName").value = medicine.name;
            document.getElementById("medicineCategory").value =
              medicine.category;
            document.getElementById("medicineStock").value = medicine.stock;
            document.getElementById("medicineExpiry").value = medicine.expiry;
            document.getElementById("medicinePrice").value = medicine.price;
          } else {
            title.textContent = "Add Medicine";
            form.reset();
          }

          modal.classList.add("show");
        }

        function closeMedicineModal() {
          document.getElementById("medicineModal").classList.remove("show");
          currentEditId = null;
        }

        function saveMedicine(e) {
          e.preventDefault();

          const medicineData = {
            name: document.getElementById("medicineName").value,
            category: document.getElementById("medicineCategory").value,
            stock: parseInt(document.getElementById("medicineStock").value),
            expiry: document.getElementById("medicineExpiry").value,
            price: parseFloat(document.getElementById("medicinePrice").value),
          };

          if (currentEditId) {
            const index = medicines.findIndex((m) => m.id === currentEditId);
            medicines[index] = { ...medicines[index], ...medicineData };
          } else {
            const newId = Math.max(...medicines.map((m) => m.id)) + 1;
            medicines.push({ id: newId, ...medicineData });
          }

          renderMedicines();
          updateDashboardStats();
          closeMedicineModal();

          // Show success message
          showNotification("Medicine saved successfully!", "success");
        }

        function editMedicine(id) {
          openMedicineModal(id);
        }

        function deleteMedicine(id) {
          if (confirm("Are you sure you want to delete this medicine?")) {
            medicines = medicines.filter((m) => m.id !== id);
            renderMedicines();
            updateDashboardStats();
            showNotification("Medicine deleted successfully!", "success");
          }
        }

        // Suppliers Management
        function renderSuppliers() {
          const grid = document.getElementById("suppliersGrid");
          grid.innerHTML = suppliers
            .map(
              (supplier) => `
                <div class="bg-white rounded-lg shadow-sm border p-6 card-hover">
                    <div class="flex items-start justify-between mb-4">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">${
                              supplier.name
                            }</h3>
                            <p class="text-gray-600">${supplier.contact}</p>
                            ${
                              supplier.email
                                ? `<p class="text-gray-600">${supplier.email}</p>`
                                : ""
                            }
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="editSupplier(${
                              supplier.id
                            })" class="text-blue-600 hover:text-blue-800">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                </svg>
                            </button>
                            <button onclick="deleteSupplier(${
                              supplier.id
                            })" class="text-red-600 hover:text-red-800">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <p class="text-sm font-medium text-gray-700 mb-1">Supply Items:</p>
                        <p class="text-sm text-gray-600">${supplier.items}</p>
                    </div>
                </div>
            `
            )
            .join("");
        }

        // Supplier Modal Functions
        document
          .getElementById("addSupplierBtn")
          .addEventListener("click", () => openSupplierModal());
        document
          .getElementById("closeSupplierModal")
          .addEventListener("click", closeSupplierModal);
        document
          .getElementById("cancelSupplier")
          .addEventListener("click", closeSupplierModal);
        document
          .getElementById("supplierForm")
          .addEventListener("submit", saveSupplier);

        function openSupplierModal(supplierId = null) {
          const modal = document.getElementById("supplierModal");
          const title = document.getElementById("supplierModalTitle");
          const form = document.getElementById("supplierForm");

          currentEditId = supplierId;

          if (supplierId) {
            title.textContent = "Edit Supplier";
            const supplier = suppliers.find((s) => s.id === supplierId);
            document.getElementById("supplierName").value = supplier.name;
            document.getElementById("supplierContact").value = supplier.contact;
            document.getElementById("supplierItems").value = supplier.items;
            document.getElementById("supplierEmail").value =
              supplier.email || "";
          } else {
            title.textContent = "Add Supplier";
            form.reset();
          }

          modal.classList.add("show");
        }

        function closeSupplierModal() {
          document.getElementById("supplierModal").classList.remove("show");
          currentEditId = null;
        }

        function saveSupplier(e) {
          e.preventDefault();

          const supplierData = {
            name: document.getElementById("supplierName").value,
            contact: document.getElementById("supplierContact").value,
            items: document.getElementById("supplierItems").value,
            email: document.getElementById("supplierEmail").value,
          };

          if (currentEditId) {
            const index = suppliers.findIndex((s) => s.id === currentEditId);
            suppliers[index] = { ...suppliers[index], ...supplierData };
          } else {
            const newId = Math.max(...suppliers.map((s) => s.id)) + 1;
            suppliers.push({ id: newId, ...supplierData });
          }

          renderSuppliers();
          closeSupplierModal();
          showNotification("Supplier saved successfully!", "success");
        }

        function editSupplier(id) {
          openSupplierModal(id);
        }

        function deleteSupplier(id) {
          if (confirm("Are you sure you want to delete this supplier?")) {
            suppliers = suppliers.filter((s) => s.id !== id);
            renderSuppliers();
            showNotification("Supplier deleted successfully!", "success");
          }
        }

        // Customers Management
        function renderCustomers() {
          const tbody = document.getElementById("customersTable");
          tbody.innerHTML = customers
            .map(
              (customer) => `
                <tr>
                    <td class="px-6 py-4">
                        <div class="font-medium text-gray-900">${
                          customer.name
                        }</div>
                    </td>
                    <td class="px-6 py-4 text-gray-900">${customer.phone}</td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-gray-600 max-w-xs truncate">${
                          customer.notes || "No notes"
                        }</div>
                    </td>
                    <td class="px-6 py-4 text-gray-900">${formatDate(
                      customer.lastVisit
                    )}</td>
                    <td class="px-6 py-4">
                        <div class="flex space-x-2">
                            <button onclick="editCustomer(${
                              customer.id
                            })" class="text-blue-600 hover:text-blue-800">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                </svg>
                            </button>
                            <button onclick="deleteCustomer(${
                              customer.id
                            })" class="text-red-600 hover:text-red-800">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </td>
                </tr>
            `
            )
            .join("");
        }

        // Customer Modal Functions
        document
          .getElementById("addCustomerBtn")
          .addEventListener("click", () => openCustomerModal());
        document
          .getElementById("closeCustomerModal")
          .addEventListener("click", closeCustomerModal);
        document
          .getElementById("cancelCustomer")
          .addEventListener("click", closeCustomerModal);
        document
          .getElementById("customerForm")
          .addEventListener("submit", saveCustomer);

        function openCustomerModal(customerId = null) {
          const modal = document.getElementById("customerModal");
          const title = document.getElementById("customerModalTitle");
          const form = document.getElementById("customerForm");

          currentEditId = customerId;

          if (customerId) {
            title.textContent = "Edit Customer";
            const customer = customers.find((c) => c.id === customerId);
            document.getElementById("customerName").value = customer.name;
            document.getElementById("customerPhone").value = customer.phone;
            document.getElementById("customerNotes").value =
              customer.notes || "";
          } else {
            title.textContent = "Add Customer";
            form.reset();
          }

          modal.classList.add("show");
        }

        function closeCustomerModal() {
          document.getElementById("customerModal").classList.remove("show");
          currentEditId = null;
        }

        function saveCustomer(e) {
          e.preventDefault();

          const customerData = {
            name: document.getElementById("customerName").value,
            phone: document.getElementById("customerPhone").value,
            notes: document.getElementById("customerNotes").value,
            lastVisit: new Date().toISOString().split("T")[0],
          };

          if (currentEditId) {
            const index = customers.findIndex((c) => c.id === currentEditId);
            customers[index] = { ...customers[index], ...customerData };
          } else {
            const newId = Math.max(...customers.map((c) => c.id)) + 1;
            customers.push({ id: newId, ...customerData });
          }

          renderCustomers();
          closeCustomerModal();
          showNotification("Customer saved successfully!", "success");
        }

        function editCustomer(id) {
          openCustomerModal(id);
        }

        function deleteCustomer(id) {
          if (confirm("Are you sure you want to delete this customer?")) {
            customers = customers.filter((c) => c.id !== id);
            renderCustomers();
            showNotification("Customer deleted successfully!", "success");
          }
        }

        // Orders Management
        function renderOrders() {
          const tbody = document.getElementById("ordersTable");
          tbody.innerHTML = orders
            .map(
              (order) => `
                <tr>
                    <td class="px-6 py-4">
                        <div class="font-medium text-gray-900">#${
                          order.id
                        }</div>
                    </td>
                    <td class="px-6 py-4 text-gray-900">${
                      order.customerName
                    }</td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-gray-600">
                            ${order.medicines
                              .map((m) => `${m.name} (${m.quantity})`)
                              .join(", ")}
                        </div>
                    </td>
                    <td class="px-6 py-4 text-gray-900">${order.total.toFixed(
                      2
                    )}</td>
                    <td class="px-6 py-4 text-gray-900">${formatDate(
                      order.date
                    )}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 text-xs rounded-full ${
                          order.status === "Completed"
                            ? "bg-green-100 text-green-800"
                            : "bg-yellow-100 text-yellow-800"
                        }">
                            ${order.status}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex space-x-2">
                            <button onclick="viewOrder(${
                              order.id
                            })" class="text-blue-600 hover:text-blue-800">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                            </button>
                            <button onclick="deleteOrder(${
                              order.id
                            })" class="text-red-600 hover:text-red-800">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </td>
                </tr>
            `
            )
            .join("");
        }

        // Order Modal Functions
        document
          .getElementById("addOrderBtn")
          .addEventListener("click", () => openOrderModal());
        document
          .getElementById("closeOrderModal")
          .addEventListener("click", closeOrderModal);
        document
          .getElementById("cancelOrder")
          .addEventListener("click", closeOrderModal);
        document
          .getElementById("orderForm")
          .addEventListener("submit", saveOrder);

        function openOrderModal() {
          const modal = document.getElementById("orderModal");
          const customerSelect = document.getElementById("orderCustomer");
          const medicinesDiv = document.getElementById("orderMedicines");

          // Populate customers
          customerSelect.innerHTML =
            '<option value="">Select Customer</option>' +
            customers
              .map((c) => `<option value="${c.id}">${c.name}</option>`)
              .join("");

          // Populate medicines with checkboxes
          medicinesDiv.innerHTML = medicines
            .map(
              (medicine) => `
                <div class="flex items-center space-x-3 p-2 border rounded">
                    <input type="checkbox" id="med_${medicine.id}" class="medicine-checkbox" 
                           data-id="${medicine.id}" data-name="${medicine.name}" data-price="${medicine.price}">
                    <label for="med_${medicine.id}" class="flex-1 cursor-pointer">
                        <span class="font-medium">${medicine.name}</span>
                        <span class="text-gray-600 ml-2">${medicine.price}</span>
                    </label>
                    <input type="number" id="qty_${medicine.id}" min="1" max="${medicine.stock}" 
                           value="1" class="w-16 px-2 py-1 border rounded medicine-quantity" disabled>
                </div>
            `
            )
            .join("");

          // Add event listeners for checkboxes and quantities
          document
            .querySelectorAll(".medicine-checkbox")
            .forEach((checkbox) => {
              checkbox.addEventListener("change", updateOrderTotal);
            });

          document.querySelectorAll(".medicine-quantity").forEach((input) => {
            input.addEventListener("input", updateOrderTotal);
            input.addEventListener("change", function () {
              const checkbox = document.getElementById(
                `med_${this.id.split("_")[1]}`
              );
              this.disabled = !checkbox.checked;
            });
          });

          modal.classList.add("show");
          updateOrderTotal();
        }

        function closeOrderModal() {
          document.getElementById("orderModal").classList.remove("show");
          document.getElementById("orderForm").reset();
        }

        function updateOrderTotal() {
          let total = 0;
          document
            .querySelectorAll(".medicine-checkbox:checked")
            .forEach((checkbox) => {
              const medicineId = checkbox.dataset.id;
              const price = parseFloat(checkbox.dataset.price);
              const quantity =
                parseInt(document.getElementById(`qty_${medicineId}`).value) ||
                1;

              // Enable quantity input
              document.getElementById(`qty_${medicineId}`).disabled = false;

              total += price * quantity;
            });

          // Disable quantity inputs for unchecked medicines
          document
            .querySelectorAll(".medicine-checkbox:not(:checked)")
            .forEach((checkbox) => {
              const medicineId = checkbox.dataset.id;
              document.getElementById(`qty_${medicineId}`).disabled = true;
            });

          document.getElementById("orderTotal").textContent = `${total.toFixed(
            2
          )}`;
        }

        function saveOrder(e) {
          e.preventDefault();

          const customerId = parseInt(
            document.getElementById("orderCustomer").value
          );
          const customer = customers.find((c) => c.id === customerId);

          if (!customer) {
            alert("Please select a customer");
            return;
          }

          const selectedMedicines = [];
          let total = 0;

          document
            .querySelectorAll(".medicine-checkbox:checked")
            .forEach((checkbox) => {
              const medicineId = parseInt(checkbox.dataset.id);
              const medicineName = checkbox.dataset.name;
              const price = parseFloat(checkbox.dataset.price);
              const quantity = parseInt(
                document.getElementById(`qty_${medicineId}`).value
              );

              selectedMedicines.push({
                id: medicineId,
                name: medicineName,
                quantity: quantity,
                price: price,
              });

              total += price * quantity;

              // Update medicine stock
              const medicineIndex = medicines.findIndex(
                (m) => m.id === medicineId
              );
              if (medicineIndex !== -1) {
                medicines[medicineIndex].stock -= quantity;
              }
            });

          if (selectedMedicines.length === 0) {
            alert("Please select at least one medicine");
            return;
          }

          const newOrderId = Math.max(...orders.map((o) => o.id)) + 1;
          const newOrder = {
            id: newOrderId,
            customerId: customerId,
            customerName: customer.name,
            medicines: selectedMedicines,
            total: total,
            date: new Date().toISOString().split("T")[0],
            status: "Completed",
          };

          orders.push(newOrder);
          renderOrders();
          renderMedicines(); // Update medicine table to reflect stock changes
          updateDashboardStats();
          closeOrderModal();
          showNotification("Order created successfully!", "success");
        }

        function viewOrder(orderId) {
          const order = orders.find((o) => o.id === orderId);
          const medicinesList = order.medicines
            .map(
              (m) =>
                `${m.name} x${m.quantity} - ${(m.price * m.quantity).toFixed(
                  2
                )}`
            )
            .join("\n");

          alert(
            `Order #${order.id}\nCustomer: ${
              order.customerName
            }\nDate: ${formatDate(order.date)}\nStatus: ${
              order.status
            }\n\nMedicines:\n${medicinesList}\n\nTotal: ${order.total.toFixed(
              2
            )}`
          );
        }

        function deleteOrder(id) {
          if (confirm("Are you sure you want to delete this order?")) {
            orders = orders.filter((o) => o.id !== id);
            renderOrders();
            updateDashboardStats();
            showNotification("Order deleted successfully!", "success");
          }
        }

        // Reports Management
        function renderReports() {
          const statsContainer = document.getElementById("reportStats");
          statsContainer.innerHTML = `
                <div class="p-4 bg-white rounded-lg shadow-sm">
                    <p class="text-gray-600 text-sm">Total Sales</p>
                    <p class="text-2xl font-bold text-gray-900">$${orders
                      .reduce((sum, o) => sum + o.total, 0)
                      .toFixed(2)}</p>
                </div>
                <div class="p-4 bg-white rounded-lg shadow-sm">
                    <p class="text-gray-600 text-sm">Total Orders</p>
                    <p class="text-2xl font-bold text-gray-900">${
                      orders.length
                    }</p>
                </div>
                <div class="p-4 bg-white rounded-lg shadow-sm">
                    <p class="text-gray-600 text-sm">Total Customers</p>
                    <p class="text-2xl font-bold text-gray-900">${
                      customers.length
                    }</p>
                </div>
                <div class="p-4 bg-white rounded-lg shadow-sm">
                    <p class="text-gray-600 text-sm">Total Medicines</p>
                    <p class="text-2xl font-bold text-gray-900">${
                      medicines.length
                    }</p>
                </div>
            `;
        }

        // XLSX Export Functions for Reports
        function exportSalesXLSX() {
          const ws_data = [
            ["Order ID", "Customer", "Medicines", "Total", "Date", "Status"],
          ];
          orders.forEach((order) => {
            const meds = order.medicines
              .map((m) => `${m.name} (${m.quantity})`)
              .join("; ");
            ws_data.push([
              order.id,
              order.customerName,
              meds,
              order.total.toFixed(2),
              order.date,
              order.status,
            ]);
          });
          const ws = XLSX.utils.aoa_to_sheet(ws_data);
          styleHeader(ws, 6);
          styleTable(ws, ws_data.length, 6);
          const wb = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(wb, ws, "Sales Report");
          XLSX.writeFile(wb, "sales_report.xlsx");
        }

        function exportInventoryXLSX() {
          const ws_data = [
            ["Medicine", "Category", "Stock", "Expiry", "Price"],
          ];
          medicines.forEach((med) => {
            ws_data.push([
              med.name,
              med.category,
              med.stock,
              med.expiry,
              med.price,
            ]);
          });
          const ws = XLSX.utils.aoa_to_sheet(ws_data);
          styleHeader(ws, 5);
          styleTable(ws, ws_data.length, 5);
          const wb = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(wb, ws, "Inventory Report");
          XLSX.writeFile(wb, "inventory_report.xlsx");
        }

        function exportCustomersXLSX() {
          const ws_data = [["Customer", "Phone", "Notes", "Last Visit"]];
          customers.forEach((cust) => {
            ws_data.push([cust.name, cust.phone, cust.notes, cust.lastVisit]);
          });
          const ws = XLSX.utils.aoa_to_sheet(ws_data);
          styleHeader(ws, 4);
          styleTable(ws, ws_data.length, 4);
          const wb = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(wb, ws, "Customer Report");
          XLSX.writeFile(wb, "customer_report.xlsx");
        }

        document
          .getElementById("exportSalesBtn")
          .addEventListener("click", function () {
            const workbook = new ExcelJS.Workbook();
            const worksheet = workbook.addWorksheet('Sales Report');
            worksheet.addRow(['Order ID', 'Customer', 'Medicines', 'Total', 'Date', 'Status']);
            if (typeof orders !== 'undefined') {
              orders.forEach(order => {
                worksheet.addRow([
                  order.id,
                  order.customerName,
                  Array.isArray(order.medicines) ? order.medicines.join('; ') : order.medicines,
                  order.total,
                  order.date,
                  order.status
                ]);
              });
            }
            worksheet.getRow(1).font = { bold: true };
            workbook.xlsx.writeBuffer().then(buffer => {
              saveAs(new Blob([buffer]), 'sales_report.xlsx');
            });
          });
        document
          .getElementById("exportInventoryBtn")
          .addEventListener("click", function () {
            const workbook = new ExcelJS.Workbook();
            const worksheet = workbook.addWorksheet('Inventory Report');
            worksheet.addRow(['Medicine', 'Category', 'Stock', 'Expiry', 'Price']);
            if (typeof medicines !== 'undefined') {
              medicines.forEach(med => {
                worksheet.addRow([
                  med.name,
                  med.category,
                  med.stock,
                  med.expiry,
                  med.price
                ]);
              });
            }
            worksheet.getRow(1).font = { bold: true };
            workbook.xlsx.writeBuffer().then(buffer => {
              saveAs(new Blob([buffer]), 'inventory_report.xlsx');
            });
          });
        document
          .getElementById("exportCustomersBtn")
          .addEventListener("click", function () {
            const workbook = new ExcelJS.Workbook();
            const worksheet = workbook.addWorksheet('Customer Report');
            worksheet.addRow(['Customer', 'Phone', 'Notes', 'Last Visit']);
            if (typeof customers !== 'undefined') {
              customers.forEach(cust => {
                worksheet.addRow([
                  cust.name,
                  cust.phone,
                  cust.notes,
                  cust.lastVisit
                ]);
              });
            }
            worksheet.getRow(1).font = { bold: true };
            workbook.xlsx.writeBuffer().then(buffer => {
              saveAs(new Blob([buffer]), 'customer_report.xlsx');
            });
          });

        // Helper to style header row (bold, border)
        function styleHeader(ws, colCount) {
          for (let c = 0; c < colCount; c++) {
            const cell = ws[XLSX.utils.encode_cell({ r: 0, c })];
            if (cell) {
              cell.s = {
                font: { bold: true },
                alignment: { horizontal: "center" },
                border: {
                  top: { style: "thin", color: { rgb: "000000" } },
                  bottom: { style: "thin", color: { rgb: "000000" } },
                  left: { style: "thin", color: { rgb: "000000" } },
                  right: { style: "thin", color: { rgb: "000000" } },
                },
              };
            }
          }
        }

        // Helper to style all table cells with borders
        function styleTable(ws, rowCount, colCount) {
          for (let r = 1; r < rowCount; r++) {
            for (let c = 0; c < colCount; c++) {
              const cell = ws[XLSX.utils.encode_cell({ r, c })];
              if (cell) {
                cell.s = {
                  border: {
                    top: { style: "thin", color: { rgb: "000000" } },
                    bottom: { style: "thin", color: { rgb: "000000" } },
                    left: { style: "thin", color: { rgb: "000000" } },
                    right: { style: "thin", color: { rgb: "000000" } },
                  },
                };
              }
            }
          }
        }

        // Utility Functions
        function formatDate(dateStr) {
          if (!dateStr) return "";
          const d = new Date(dateStr);
          return d.toLocaleDateString("en-US", {
            year: "numeric",
            month: "short",
            day: "numeric",
          });
        }

        function showNotification(message, type = "success") {
          // Simple notification (can be improved)
          const notif = document.createElement("div");
          notif.className = `fixed top-6 right-6 z-50 px-6 py-3 rounded-lg shadow-lg text-white font-semibold ${
            type === "success" ? "bg-primary" : "bg-red-600"
          }`;
          notif.textContent = message;
          document.body.appendChild(notif);
          setTimeout(() => notif.remove(), 2500);
        }

        // Initial Render
        showLandingPage();
        renderMedicines();
        renderSuppliers();
        renderCustomers();
        renderOrders();
        updateDashboardStats();
        renderRecentActivity();
      });
    </script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap");
      body {
        font-family: "Inter", sans-serif;
      }
      .gradient-bg {
        background: linear-gradient(135deg, #16a34a 0%, #22c55e 100%);
      }
      .card-hover {
        transition: all 0.3s ease;
      }
      .card-hover:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      }
      .fade-in {
        animation: fadeIn 0.6s ease-in;
      }
      .slide-up {
        animation: slideUp 0.8s ease-out;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .stats-card {
        background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      }
      .low-stock {
        background-color: #fef2f2;
        border-left: 4px solid #ef4444;
      }
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
      }
      .modal.show {
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .animate-pulse-slow {
        animation: pulse 3s infinite;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <div class="flex items-center space-x-3">
            <div
              class="w-10 h-10 bg-primary rounded-lg flex items-center justify-center"
            >
              <svg
                class="w-6 h-6 text-white"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.78 0-2.678-2.153-1.415-3.414l5-5A2 2 0 009 11.172V5l-1-1z"
                ></path>
              </svg>
            </div>
            <h1 class="text-xl font-bold text-gray-900">Nyina wa Jambo Pharmacy</h1>
          </div>
          <div class="flex space-x-4">
            <button
              id="homeBtn"
              class="px-4 py-2 text-primary hover:text-primary-dark font-medium transition-colors"
            >
              Home
            </button>
            <button
              id="dashboardBtn"
              class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors"
            >
              Dashboard
            </button>
          </div>
        </div>
      </div>
    </nav>

    <!-- Landing Page -->
    <div id="landingPage" class="min-h-screen">
      <!-- Hero Section -->
      <section class="gradient-bg text-white py-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
          <div class="slide-up">
            <h2 class="text-5xl font-bold mb-6">Your Health, Our Priority</h2>
            <p class="text-xl mb-8 text-green-100 max-w-3xl mx-auto">
              Modern pharmacy management system designed to streamline
              operations, track inventory, and provide exceptional customer
              service.
            </p>
            <button
              id="getStartedBtn"
              class="bg-white text-primary px-8 py-4 rounded-lg font-semibold text-lg hover:bg-gray-100 transition-all transform hover:scale-105"
            >
              Get Started Today
            </button>
          </div>
        </div>
      </section>

      <!-- Services Section -->
      <section class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="text-center mb-16 fade-in">
            <h3 class="text-3xl font-bold text-gray-900 mb-4">
              Comprehensive Pharmacy Solutions
            </h3>
            <p class="text-gray-600 text-lg">
              Everything you need to run a modern pharmacy efficiently
            </p>
          </div>
          <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
            <div class="text-center p-6 rounded-lg card-hover">
              <div
                class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"
              >
                <svg
                  class="w-8 h-8 text-primary"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                  ></path>
                </svg>
              </div>
              <h4 class="text-xl font-semibold text-gray-900 mb-2">
                Online Prescription Management
              </h4>
              <p class="text-gray-600">
                Digital prescription processing and management system
              </p>
            </div>
            <div class="text-center p-6 rounded-lg card-hover">
              <div
                class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"
              >
                <svg
                  class="w-8 h-8 text-primary"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"
                  ></path>
                </svg>
              </div>
              <h4 class="text-xl font-semibold text-gray-900 mb-2">
                Inventory Tracking
              </h4>
              <p class="text-gray-600">
                Real-time stock monitoring with automated alerts
              </p>
            </div>
            <div class="text-center p-6 rounded-lg card-hover">
              <div
                class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"
              >
                <svg
                  class="w-8 h-8 text-primary"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 17v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 012 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                  ></path>
                </svg>
              </div>
              <h4 class="text-xl font-semibold text-gray-900 mb-2">
                Sales Reports
              </h4>
              <p class="text-gray-600">
                Comprehensive analytics and reporting tools
              </p>
            </div>
            <div class="text-center p-6 rounded-lg card-hover">
              <div
                class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"
              >
                <svg
                  class="w-8 h-8 text-primary"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192L5.636 18.364M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
                  ></path>
                </svg>
              </div>
              <h4 class="text-xl font-semibold text-gray-900 mb-2">
                Customer Support
              </h4>
              <p class="text-gray-600">
                24/7 customer assistance and consultation
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Pain Points Section -->
      <section class="py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="text-center mb-16">
            <h3 class="text-3xl font-bold text-gray-900 mb-4">
              Problems We Solve
            </h3>
            <p class="text-gray-600 text-lg">
              Common pharmacy challenges that we address
            </p>
          </div>
          <div class="grid md:grid-cols-2 gap-8">
            <div
              class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-red-500"
            >
              <h4 class="text-xl font-semibold text-gray-900 mb-2">
                ❌ Manual Stock Management
              </h4>
              <p class="text-gray-600">
                Leads to errors, overstocking, and missed opportunities
              </p>
            </div>
            <div
              class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-red-500"
            >
              <h4 class="text-xl font-semibold text-gray-900 mb-2">
                ❌ Expiry Date Tracking
              </h4>
              <p class="text-gray-600">
                Hard to monitor expiry dates, resulting in waste and losses
              </p>
            </div>
            <div
              class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-red-500"
            >
              <h4 class="text-xl font-semibold text-gray-900 mb-2">
                ❌ Paper-Based Prescriptions
              </h4>
              <p class="text-gray-600">
                Time-consuming and prone to human error
              </p>
            </div>
            <div
              class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-red-500"
            >
              <h4 class="text-xl font-semibold text-gray-900 mb-2">
                ❌ No Instant Reports
              </h4>
              <p class="text-gray-600">
                Weak decision making due to lack of real-time data
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Testimonials -->
      <section class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="text-center mb-16">
            <h3 class="text-3xl font-bold text-gray-900 mb-4">
              What Our Clients Say
            </h3>
          </div>
          <div class="grid md:grid-cols-3 gap-8">
            <div class="bg-gray-50 p-6 rounded-lg">
              <p class="text-gray-600 mb-4">
                "This system has transformed how we manage our pharmacy. Stock
                management is now effortless!"
              </p>
              <div class="flex items-center">
                <div
                  class="w-12 h-12 bg-primary rounded-full flex items-center justify-center text-white font-bold"
                >
                  JD
                </div>
                <div class="ml-3">
                  <p class="font-semibold text-gray-900">Dr. John Davis</p>
                  <p class="text-gray-500">Central Pharmacy</p>
                </div>
              </div>
            </div>
            <div class="bg-gray-50 p-6 rounded-lg">
              <p class="text-gray-600 mb-4">
                "Real-time inventory tracking has saved us thousands in expired
                medications. Highly recommended!"
              </p>
              <div class="flex items-center">
                <div
                  class="w-12 h-12 bg-primary rounded-full flex items-center justify-center text-white font-bold"
                >
                  SM
                </div>
                <div class="ml-3">
                  <p class="font-semibold text-gray-900">Sarah Miller</p>
                  <p class="text-gray-500">HealthCare Pharmacy</p>
                </div>
              </div>
            </div>
            <div class="bg-gray-50 p-6 rounded-lg">
              <p class="text-gray-600 mb-4">
                "The reporting features give us insights we never had before.
                Our profits have increased by 30%!"
              </p>
              <div class="flex items-center">
                <div
                  class="w-12 h-12 bg-primary rounded-full flex items-center justify-center text-white font-bold"
                >
                  RK
                </div>
                <div class="ml-3">
                  <p class="font-semibold text-gray-900">Robert Kim</p>
                  <p class="text-gray-500">MediCare Plus</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Contact Section -->
      <section class="py-20 gradient-bg text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
          <h3 class="text-3xl font-bold mb-8">Ready to Get Started?</h3>
          <p class="text-xl mb-8 text-green-100">
            Contact us today for a personalized demo
          </p>
          <div
            class="flex flex-col md:flex-row justify-center items-center space-y-4 md:space-y-0 md:space-x-8"
          >
            <div class="flex items-center space-x-2">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                <path
                  d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"
                ></path>
                <path
                  d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"
                ></path>
              </svg>
              <span>demo@concordepharmacy.com</span>
            </div>
            <div class="flex items-center space-x-2">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                <path
                  d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"
                ></path>
              </svg>
              <span>+1 (555) 123-4567</span>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Dashboard -->
    <div id="dashboardPage" class="hidden min-h-screen bg-gray-50">
      <div class="flex">
        <!-- Sidebar -->
        <div class="w-64 bg-white shadow-sm h-screen sticky top-16">
          <nav class="p-4 space-y-2">
            <button
              class="sidebar-btn w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 font-medium text-gray-700"
              data-section="overview"
            >
              <svg
                class="w-5 h-5 inline mr-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"
                ></path>
              </svg>
              Dashboard Overview
            </button>
            <button
              class="sidebar-btn w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 font-medium text-gray-700"
              data-section="medicines"
            >
              <svg
                class="w-5 h-5 inline mr-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.78 0-2.678-2.153-1.415-3.414l5-5A2 2 0 009 11.172V5l-1-1z"
                ></path>
              </svg>
              Medicines
            </button>
            <button
              class="sidebar-btn w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 font-medium text-gray-700"
              data-section="suppliers"
            >
              <svg
                class="w-5 h-5 inline mr-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
                ></path>
              </svg>
              Suppliers
            </button>
            <button
              class="sidebar-btn w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 font-medium text-gray-700"
              data-section="customers"
            >
              <svg
                class="w-5 h-5 inline mr-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0zM3 20a6 6 0 0112 0v1H3v-1z"
                ></path>
              </svg>
              Customers
            </button>
            <button
              class="sidebar-btn w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 font-medium text-gray-700"
              data-section="orders"
            >
              <svg
                class="w-5 h-5 inline mr-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"
                ></path>
              </svg>
              Orders
            </button>
            <button
              class="sidebar-btn w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 font-medium text-gray-700"
              data-section="reports"
            >
              <svg
                class="w-5 h-5 inline mr-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                ></path>
              </svg>
              Reports
            </button>
          </nav>
        </div>

        <!-- Main Content -->
        <div class="flex-1 p-8">
          <!-- Overview Section -->
          <div id="overview-section" class="section">
            <!-- Excel Import Section -->
            <!-- <div class="bg-white rounded-lg shadow-sm border p-6 mb-8">
              <h3 class="text-xl font-semibold text-gray-900 mb-4">
                Import Excel Sheet
              </h3>
              <input
                type="file"
                id="excelImportInput"
                accept=".xlsx,.xls"
                class="mb-4 block"
              />
              <div id="excelImportTableContainer" class="overflow-x-auto"></div>
            </div> -->
         
            <h2 class="text-3xl font-bold text-gray-900 mb-8">
              Dashboard Overview
            </h2>

            <!-- Stats Cards -->
            <div
              class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"
            >
              <div class="stats-card p-6 rounded-lg border">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-gray-600 text-sm">Total Medicines</p>
                    <p
                      id="totalMedicines"
                      class="text-3xl font-bold text-gray-900"
                    >
                      0
                    </p>
                  </div>
                  <div
                    class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center"
                  >
                    <svg
                      class="w-6 h-6 text-blue-600"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.78 0-2.678-2.153-1.415-3.414l5-5A2 2 0 009 11.172V5l-1-1z"
                      ></path>
                    </svg>
                  </div>
                </div>
              </div>
              <div class="stats-card p-6 rounded-lg border">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-gray-600 text-sm">Low Stock Items</p>
                    <p id="lowStock" class="text-3xl font-bold text-red-600">
                      0
                    </p>
                  </div>
                  <div
                    class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center"
                  >
                    <svg
                      class="w-6 h-6 text-red-600"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.232 16.5c-.77.833.192 2.5 1.732 2.5z"
                      ></path>
                    </svg>
                  </div>
                </div>
              </div>
              <div class="stats-card p-6 rounded-lg border">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-gray-600 text-sm">Total Orders</p>
                    <p
                      id="totalOrders"
                      class="text-3xl font-bold text-gray-900"
                    >
                      0
                    </p>
                  </div>
                  <div
                    class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center"
                  >
                    <svg
                      class="w-6 h-6 text-primary"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"
                      ></path>
                    </svg>
                  </div>
                </div>
              </div>
              <div class="stats-card p-6 rounded-lg border">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-gray-600 text-sm">Revenue Today</p>
                    <p
                      id="todayRevenue"
                      class="text-3xl font-bold text-gray-900"
                    >
                      $0
                    </p>
                  </div>
                  <div
                    class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center"
                  >
                    <svg
                      class="w-6 h-6 text-yellow-600"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"
                      ></path>
                    </svg>
                  </div>
                </div>
              </div>
            </div>

            <!-- Recent Activity -->
            <div class="bg-white rounded-lg shadow-sm border p-6">
              <h3 class="text-xl font-semibold text-gray-900 mb-4">
                Recent Activity
              </h3>
              <div id="recentActivity" class="space-y-3">
                <!-- Activity items will be populated here -->
              </div>
            </div>
          </div>

          <!-- Medicines Section -->
          <div id="medicines-section" class="section hidden">
            <div class="flex justify-between items-center mb-8">
              <h2 class="text-3xl font-bold text-gray-900">
                Medicines Inventory
              </h2>
              <button
                id="addMedicineBtn"
                class="bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary-dark transition-colors"
              >
                <svg
                  class="w-5 h-5 inline mr-2"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                  ></path>
                </svg>
                Add Medicine
              </button>
            </div>

            <!-- Search and Filter -->
            <div class="bg-white rounded-lg shadow-sm border p-4 mb-6">
              <div class="flex flex-col md:flex-row gap-4">
                <div class="flex-1">
                  <input
                    id="medicineSearch"
                    type="text"
                    placeholder="Search medicines..."
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                  />
                </div>
                <select
                  id="categoryFilter"
                  class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
                >
                  <option value="">All Categories</option>
                  <option value="Antibiotics">Antibiotics</option>
                  <option value="Pain Relief">Pain Relief</option>
                  <option value="Vitamins">Vitamins</option>
                  <option value="Heart">Heart</option>
                  <option value="Diabetes">Diabetes</option>
                </select>
              </div>
            </div>

            <!-- Medicines Table -->
            <div class="bg-white rounded-lg shadow-sm border overflow-hidden">
              <div class="overflow-x-auto">
                <table class="w-full">
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Medicine
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Category
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Stock
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Expiry Date
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Price
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Actions
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    id="medicinesTable"
                    class="bg-white divide-y divide-gray-200"
                  ></tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Suppliers Section -->
          <div id="suppliers-section" class="section hidden">
            <div class="flex justify-between items-center mb-8">
              <h2 class="text-3xl font-bold text-gray-900">Suppliers</h2>
              <button
                id="addSupplierBtn"
                class="bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary-dark transition-colors"
              >
                <svg
                  class="w-5 h-5 inline mr-2"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                  ></path>
                </svg>
                Add Supplier
              </button>
            </div>

            <div class="grid gap-6">
              <div
                id="suppliersGrid"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
              ></div>
            </div>
          </div>

          <!-- Customers Section -->
          <div id="customers-section" class="section hidden">
            <div class="flex justify-between items-center mb-8">
              <h2 class="text-3xl font-bold text-gray-900">Customers</h2>
              <button
                id="addCustomerBtn"
                class="bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary-dark transition-colors"
              >
                <svg
                  class="w-5 h-5 inline mr-2"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                  ></path>
                </svg>
                Add Customer
              </button>
            </div>

            <div class="bg-white rounded-lg shadow-sm border overflow-hidden">
              <div class="overflow-x-auto">
                <table class="w-full">
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Customer
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Phone
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Prescription Notes
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Last Visit
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Actions
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    id="customersTable"
                    class="bg-white divide-y divide-gray-200"
                  ></tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Orders Section -->
          <div id="orders-section" class="section hidden">
            <div class="flex justify-between items-center mb-8">
              <h2 class="text-3xl font-bold text-gray-900">Orders</h2>
              <button
                id="addOrderBtn"
                class="bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary-dark transition-colors"
              >
                <svg
                  class="w-5 h-5 inline mr-2"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                  ></path>
                </svg>
                Create Order
              </button>
            </div>

            <div class="bg-white rounded-lg shadow-sm border overflow-hidden">
              <div class="overflow-x-auto">
                <table class="w-full">
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Order ID
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Customer
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Medicines
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Total Price
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Date
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Status
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Actions
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    id="ordersTable"
                    class="bg-white divide-y divide-gray-200"
                  ></tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Reports Section -->
          <div id="reports-section" class="section hidden">
            <h2 class="text-3xl font-bold text-gray-900 mb-8">Sales Reports</h2>

            <div
              class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8"
            >
              <button
                id="exportSalesBtn"
                class="bg-white border-2 border-primary text-primary px-6 py-4 rounded-lg hover:bg-primary hover:text-white transition-colors"
              >
                <svg
                  class="w-8 h-8 mx-auto mb-2"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                  ></path>
                </svg>
                <span class="block font-semibold">Export Sales Report</span>
                <span class="block text-sm opacity-75">Download CSV</span>
              </button>
              <button
                id="exportInventoryBtn"
                class="bg-white border-2 border-primary text-primary px-6 py-4 rounded-lg hover:bg-primary hover:text-white transition-colors"
              >
                <svg
                  class="w-8 h-8 mx-auto mb-2"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                  ></path>
                </svg>
                <span class="block font-semibold">Inventory Report</span>
                <span class="block text-sm opacity-75">Current Stock</span>
              </button>
              <button
                id="exportCustomersBtn"
                class="bg-white border-2 border-primary text-primary px-6 py-4 rounded-lg hover:bg-primary hover:text-white transition-colors"
              >
                <svg
                  class="w-8 h-8 mx-auto mb-2"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
                  ></path>
                </svg>
                <span class="block font-semibold">Customer Report</span>
                <span class="block text-sm opacity-75">Download List</span>
              </button>
            </div>

            <div class="bg-white rounded-lg shadow-sm border p-6 mb-8">
  <h3 class="text-xl font-semibold text-gray-900 mb-4">Import Excel Sheet</h3>
  <input type="file" id="excelImportInput" accept=".xlsx,.xls" class="mb-4 block" />
  <div id="excelImportTableContainer" class="overflow-x-auto"></div>
</div>

            <div class="bg-white rounded-lg shadow-sm border p-6">
              <h3 class="text-xl font-semibold text-gray-900 mb-4">
                Quick Statistics
              </h3>
              <div
                id="reportStats"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modals -->
    <!-- Medicine Modal -->
    <div id="medicineModal" class="modal">
      <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
        <div class="flex justify-between items-center mb-4">
          <h3
            id="medicineModalTitle"
            class="text-xl font-semibold text-gray-900"
          >
            Add Medicine
          </h3>
          <button
            id="closeMedicineModal"
            class="text-gray-400 hover:text-gray-600"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              ></path>
            </svg>
          </button>
        </div>
        <form id="medicineForm">
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Medicine Name</label
              >
              <input
                id="medicineName"
                type="text"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Category</label
              >
              <select
                id="medicineCategory"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
              >
                <option value="">Select Category</option>
                <option value="Antibiotics">Antibiotics</option>
                <option value="Pain Relief">Pain Relief</option>
                <option value="Vitamins">Vitamins</option>
                <option value="Heart">Heart</option>
                <option value="Diabetes">Diabetes</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Stock Quantity</label
              >
              <input
                id="medicineStock"
                type="number"
                required
                min="0"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Expiry Date</label
              >
              <input
                id="medicineExpiry"
                type="date"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Price ($)</label
              >
              <input
                id="medicinePrice"
                type="number"
                required
                min="0"
                step="0.01"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
              />
            </div>
          </div>
          <div class="flex justify-end space-x-3 mt-6">
            <button
              type="button"
              id="cancelMedicine"
              class="px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark"
            >
              Save Medicine
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Supplier Modal -->
    <div id="supplierModal" class="modal">
      <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
        <div class="flex justify-between items-center mb-4">
          <h3
            id="supplierModalTitle"
            class="text-xl font-semibold text-gray-900"
          >
            Add Supplier
          </h3>
          <button
            id="closeSupplierModal"
            class="text-gray-400 hover:text-gray-600"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              ></path>
            </svg>
          </button>
        </div>
        <form id="supplierForm">
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Supplier Name</label
              >
              <input
                id="supplierName"
                type="text"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Contact Number</label
              >
              <input
                id="supplierContact"
                type="tel"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Supply Items</label
              >
              <textarea
                id="supplierItems"
                rows="3"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
                placeholder="e.g., Antibiotics, Pain Relief, Vitamins"
              ></textarea>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Email</label
              >
              <input
                id="supplierEmail"
                type="email"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
              />
            </div>
          </div>
          <div class="flex justify-end space-x-3 mt-6">
            <button
              type="button"
              id="cancelSupplier"
              class="px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark"
            >
              Save Supplier
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Customer Modal -->
    <div id="customerModal" class="modal">
      <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
        <div class="flex justify-between items-center mb-4">
          <h3
            id="customerModalTitle"
            class="text-xl font-semibold text-gray-900"
          >
            Add Customer
          </h3>
          <button
            id="closeCustomerModal"
            class="text-gray-400 hover:text-gray-600"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              ></path>
            </svg>
          </button>
        </div>
        <form id="customerForm">
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Customer Name</label
              >
              <input
                id="customerName"
                type="text"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Phone Number</label
              >
              <input
                id="customerPhone"
                type="tel"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Prescription Notes</label
              >
              <textarea
                id="customerNotes"
                rows="3"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
                placeholder="Medical conditions, allergies, etc."
              ></textarea>
            </div>
          </div>
          <div class="flex justify-end space-x-3 mt-6">
            <button
              type="button"
              id="cancelCustomer"
              class="px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark"
            >
              Save Customer
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Order Modal -->
    <div id="orderModal" class="modal">
      <div
        class="bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-screen overflow-y-auto"
      >
        <div class="flex justify-between items-center mb-4">
          <h3 id="orderModalTitle" class="text-xl font-semibold text-gray-900">
            Create Order
          </h3>
          <button
            id="closeOrderModal"
            class="text-gray-400 hover:text-gray-600"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              ></path>
            </svg>
          </button>
        </div>
        <form id="orderForm">
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Customer</label
              >
              <select
                id="orderCustomer"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
              >
                <option value="">Select Customer</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Medicines</label
              >
              <div
                id="orderMedicines"
                class="space-y-3 max-h-64 overflow-y-auto border border-gray-200 rounded-lg p-3"
              ></div>
            </div>
            <div class="bg-gray-50 p-4 rounded-lg">
              <div
                class="flex justify-between items-center text-lg font-semibold"
              >
                <span>Total Price:</span>
                <span id="orderTotal" class="text-primary">$0.00</span>
              </div>
            </div>
          </div>
          <div class="flex justify-end space-x-3 mt-6">
            <button
              type="button"
              id="cancelOrder"
              class="px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark"
            >
              Create Order
            </button>
          </div>
        </form>
      </div>
    </div>

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#16A34A",
              "primary-dark": "#15803D",
              "primary-light": "#22C55E",
            },
          },
        },
      };

        document.getElementById('excelImportInput').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(evt) {
      const buffer = evt.target.result;
      const workbook = new ExcelJS.Workbook();
      workbook.xlsx.load(buffer).then(function() {
        const worksheet = workbook.worksheets[0];
        const rows = [];
        worksheet.eachRow({ includeEmpty: true }, function(row, rowNumber) {
          rows.push(row.values.slice(1)); // Remove first empty value
        });
        renderExcelImportTable(rows);
      });
    };
    reader.readAsArrayBuffer(file);
  });

  function renderExcelImportTable(rows) {
    if (!rows || rows.length === 0) {
      document.getElementById('excelImportTableContainer').innerHTML = '<p class="text-gray-500">No data found in the sheet.</p>';
      return;
    }
    let html = '<table class="min-w-full bg-white border rounded-lg"><thead><tr>';
    rows[0].forEach(cell => {
      html += `<th class="px-4 py-2 border-b bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">${cell}</th>`;
    });
    html += '</tr></thead><tbody>';
    for (let i = 1; i < rows.length; i++) {
      html += '<tr>';
      rows[i].forEach(cell => {
        html += `<td class="px-4 py-2 border-b">${cell !== undefined ? cell : ''}</td>`;
      });
      html += '</tr>';
    }
    html += '</tbody></table>';
    document.getElementById('excelImportTableContainer').innerHTML = html;
  }
    </script>
  </body>
</html>
